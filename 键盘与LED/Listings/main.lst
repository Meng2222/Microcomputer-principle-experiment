C51 COMPILER V9.56.0.0   MAIN                                                              09/04/2017 21:22:16 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Program Files (x86)\Keil\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRIN
                    -T(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "HD7279.h"
   2          #include "delay.h"
   3          #include "main.h"
   4          
   5          typedef enum
   6          {
   7                  rollingLeft,
   8                  rollingRight,
   9                  showKeyNumTogether,
  10                  idle
  11          }ledStatus_t;
  12          
  13          unsigned char code realCode[] = \
  14                  {0x7e , 0x30 , 0x6d , 0x79 , 0x33 , 0x5b , 0x5f , 0x70 , 0x7f , 0x7b , 0x01 , 0x80 , 0x00 , 0x6f};
  15          //      0               1               2               3               4               5       6               7               8       9               -               .               blank   error
  16          
  17          
  18          void main(void)
  19          {
  20   1      #define ROLL_PERIOD (25)
  21   1              ledStatus_t status = rollingLeft;
  22   1              unsigned char i,j = 0;
  23   1              unsigned char keyState = 0;
  24   1              unsigned char rollPeriod = ROLL_PERIOD;
  25   1              P1 = 0x00;
  26   1              
  27   1              DelayMs(25);
  28   1              
  29   1      //      for(j = 0 ; j < 10 ; j++)
  30   1      //      {
  31   1              for(i = 0 ; i < 8 ; i++)
  32   1              {
  33   2                      LedWrite(0x97 - i, realCode[8 - i]);
  34   2              }
  35   1      //      DelayMs(250);
  36   1      //      }
  37   1              while(1)
  38   1              {
  39   2                      DelayMs(10);
  40   2                      keyState = KeyRead();
  41   2                      switch(status)
  42   2                      {
  43   3                              case rollingLeft:
  44   3                                      if(keyState==0xff)
  45   3                                      {
  46   4                                              rollPeriod--;
  47   4                                              if(rollPeriod == 0)
  48   4                                              {
  49   5                                                      rollPeriod = ROLL_PERIOD;
  50   5                                                      HD7279SendByte(RTL_CYCLE);
  51   5                                              }
  52   4                                      }
  53   3                                      else if(keyState == KEY10)
  54   3                                      {
C51 COMPILER V9.56.0.0   MAIN                                                              09/04/2017 21:22:16 PAGE 2   

  55   4                                              rollPeriod = ROLL_PERIOD;
  56   4                                              HD7279SendByte(CMD_RESET);
  57   4                                              status = showKeyNumTogether;
  58   4                                      }
  59   3                              break;
  60   3                              case rollingRight:
  61   3                                      if(keyState == 0xff)
  62   3                                      {
  63   4                                              rollPeriod--;
  64   4                                              if(rollPeriod == 0)
  65   4                                              {
  66   5                                                      rollPeriod = ROLL_PERIOD;
  67   5                                                      HD7279SendByte(RTR_CYCLE);
  68   5                                              }
  69   4                                      }
  70   3                                      else if(keyState == KEY10)
  71   3                                      {
  72   4                                              rollPeriod = ROLL_PERIOD;
  73   4                                              HD7279SendByte(CMD_RESET);
  74   4                                              status = showKeyNumTogether;                            
  75   4                                      }
  76   3                              break;
  77   3                              case showKeyNumTogether:
  78   3                                      switch(keyState)
  79   3                                      {
  80   4                                              case KEY0:
  81   4                                                      for(i = 0 ; i < 8 ; i++)
  82   4                                                      {
  83   5                                                              LedWrite(0x97 - i, realCode[0]);
  84   5                                                      }
  85   4                                              break;
  86   4                                              case KEY1:
  87   4                                                      for(i = 0 ; i < 8 ; i++)
  88   4                                                      {
  89   5                                                              LedWrite(0x97 - i, realCode[1]);
  90   5                                                      }
  91   4                                              break;
  92   4                                              case KEY2:
  93   4                                                      for(i = 0 ; i < 8 ; i++)
  94   4                                                      {
  95   5                                                              LedWrite(0x97 - i, realCode[2]);
  96   5                                                      }
  97   4                                              break;
  98   4                                              case KEY3:
  99   4                                                      for(i = 0 ; i < 8 ; i++)
 100   4                                                      {
 101   5                                                              LedWrite(0x97 - i, realCode[3]);
 102   5                                                      }
 103   4                                              break;
 104   4                                              case KEY4:
 105   4                                                      for(i = 0 ; i < 8 ; i++)
 106   4                                                      {
 107   5                                                              LedWrite(0x97 - i, realCode[4]);
 108   5                                                      }                                       
 109   4                                              break;
 110   4                                              case KEY5:
 111   4                                                      for(i = 0 ; i < 8 ; i++)
 112   4                                                      {
 113   5                                                              LedWrite(0x97 - i, realCode[5]);
 114   5                                                      }                                       
 115   4                                              break;
 116   4                                              case KEY6:
C51 COMPILER V9.56.0.0   MAIN                                                              09/04/2017 21:22:16 PAGE 3   

 117   4                                                      for(i = 0 ; i < 8 ; i++)
 118   4                                                      {
 119   5                                                              LedWrite(0x97 - i, realCode[6]);
 120   5                                                      }                                       
 121   4                                              break;
 122   4                                              case KEY7:
 123   4                                                      for(i = 0 ; i < 8 ; i++)
 124   4                                                      {
 125   5                                                              LedWrite(0x97 - i, realCode[7]);
 126   5                                                      }                                       break;
 127   4                                              case KEY8:
 128   4                                                      for(i = 0 ; i < 8 ; i++)
 129   4                                                      {
 130   5                                                              LedWrite(0x97 - i, realCode[8]);
 131   5                                                      }                                       
 132   4                                              break;
 133   4                                              case KEY9:
 134   4                                                      for(i = 0 ; i < 8 ; i++)
 135   4                                                      {
 136   5                                                              LedWrite(0x97 - i, realCode[9]);
 137   5                                                      }                                       
 138   4                                              break;
 139   4                                              default:
 140   4                                              break;
 141   4                                      }       
 142   3                              break;
 143   3                              case idle:
 144   3                              break;
 145   3                      }
 146   2      
 147   2              }
 148   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    505    ----
   CONSTANT SIZE    =     14    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
