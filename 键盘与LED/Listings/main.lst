C51 COMPILER V9.56.0.0   MAIN                                                              09/05/2017 23:58:13 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Program Files (x86)\Keil\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRIN
                    -T(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "HD7279.h"
   2          #include "delay.h"
   3          #include "main.h"
   4          
   5          typedef enum
   6          {
   7                  rollingLeft,
   8                  rollingRight,
   9                  showKeyNumTogether,
  10                  idle
  11          }ledStatus_t;
  12          
  13          unsigned char code realCode[] = \
  14                  {0x7e , 0x30 , 0x6d , 0x79 , 0x33 , 0x5b , 0x5f , 0x70 , 0x7f , 0x7b , 0x01 , 0x80 , 0x00 , 0x6f};
  15          //      0               1               2               3               4               5       6               7               8       9               -               .               blank   error
  16          
  17          
  18          void main(void)
  19          {
  20   1      #define ROLL_PERIOD (15)
  21   1              ledStatus_t status = rollingLeft;
  22   1              unsigned char i,j = 0;
  23   1              unsigned char keyState = 0;
  24   1              unsigned char rollPeriod = ROLL_PERIOD;
  25   1              P1 = 0x00;
  26   1              
  27   1              DelayMs(25);
  28   1              
  29   1      //      for(j = 0 ; j < 10 ; j++)
  30   1      //      {
  31   1              for(i = 0 ; i < 8 ; i++)
  32   1              {
  33   2                      LedWrite(0x97 - i, realCode[8 - i]);
  34   2              }
  35   1      //      DelayMs(250);
  36   1      //      }
  37   1              while(1)
  38   1              {
  39   2                      DelayMs(20);
  40   2      
  41   2                      keyState = KeyRead();
  42   2      
  43   2                      switch(status)
  44   2                      {
  45   3                              case rollingLeft:
  46   3                                      if(keyState==0xff)
  47   3                                      {
  48   4                                              rollPeriod--;
  49   4                                              if(rollPeriod == 0)
  50   4                                              {
  51   5                                                      rollPeriod = ROLL_PERIOD;
  52   5                                                      HD7279SendByte(RTL_CYCLE);
  53   5                                              }
  54   4                                      }
C51 COMPILER V9.56.0.0   MAIN                                                              09/05/2017 23:58:13 PAGE 2   

  55   3                                      else if(keyState == KEY10)
  56   3                                      {
  57   4                                              rollPeriod = ROLL_PERIOD;
  58   4                                              HD7279SendByte(CMD_RESET);
  59   4                                              status = showKeyNumTogether;
  60   4                                      }
  61   3                              break;
  62   3                              case rollingRight:
  63   3                                      if(keyState == 0xff)
  64   3                                      {
  65   4                                              rollPeriod--;
  66   4                                              if(rollPeriod == 0)
  67   4                                              {
  68   5                                                      rollPeriod = ROLL_PERIOD;
  69   5                                                      HD7279SendByte(RTR_CYCLE);
  70   5                                              }
  71   4                                      }
  72   3                                      else if(keyState == KEY10)
  73   3                                      {
  74   4                                              rollPeriod = ROLL_PERIOD;
  75   4                                              HD7279SendByte(CMD_RESET);
  76   4                                              status = showKeyNumTogether;                            
  77   4                                      }
  78   3                              break;
  79   3                              case showKeyNumTogether:
  80   3                                      switch(keyState)
  81   3                                      {
  82   4                                              case KEY0:
  83   4                                                      for(i = 0 ; i < 8 ; i++)
  84   4                                                      {
  85   5                                                              LedWrite(0x97 - i, realCode[0]);
  86   5                                                      }
  87   4                                              break;
  88   4                                              case KEY1:
  89   4                                                      for(i = 0 ; i < 8 ; i++)
  90   4                                                      {
  91   5                                                              LedWrite(0x97 - i, realCode[1]);
  92   5                                                      }
  93   4                                              break;
  94   4                                              case KEY2:
  95   4                                                      for(i = 0 ; i < 8 ; i++)
  96   4                                                      {
  97   5                                                              LedWrite(0x97 - i, realCode[2]);
  98   5                                                      }
  99   4                                              break;
 100   4                                              case KEY3:
 101   4                                                      for(i = 0 ; i < 8 ; i++)
 102   4                                                      {
 103   5                                                              LedWrite(0x97 - i, realCode[3]);
 104   5                                                      }
 105   4                                              break;
 106   4                                              case KEY4:
 107   4                                                      for(i = 0 ; i < 8 ; i++)
 108   4                                                      {
 109   5                                                              LedWrite(0x97 - i, realCode[4]);
 110   5                                                      }                                       
 111   4                                              break;
 112   4                                              case KEY5:
 113   4                                                      for(i = 0 ; i < 8 ; i++)
 114   4                                                      {
 115   5                                                              LedWrite(0x97 - i, realCode[5]);
 116   5                                                      }                                       
C51 COMPILER V9.56.0.0   MAIN                                                              09/05/2017 23:58:13 PAGE 3   

 117   4                                              break;
 118   4                                              case KEY6:
 119   4                                                      for(i = 0 ; i < 8 ; i++)
 120   4                                                      {
 121   5                                                              LedWrite(0x97 - i, realCode[6]);
 122   5                                                      }                                       
 123   4                                              break;
 124   4                                              case KEY7:
 125   4                                                      for(i = 0 ; i < 8 ; i++)
 126   4                                                      {
 127   5                                                              LedWrite(0x97 - i, realCode[7]);
 128   5                                                      }                                       break;
 129   4                                              case KEY8:
 130   4                                                      for(i = 0 ; i < 8 ; i++)
 131   4                                                      {
 132   5                                                              LedWrite(0x97 - i, realCode[8]);
 133   5                                                      }                                       
 134   4                                              break;
 135   4                                              case KEY9:
 136   4                                                      for(i = 0 ; i < 8 ; i++)
 137   4                                                      {
 138   5                                                              LedWrite(0x97 - i, realCode[9]);
 139   5                                                      }                                       
 140   4                                              break;
 141   4                                              default:
 142   4                                              break;
 143   4                                      }       
 144   3                              break;
 145   3                              case idle:
 146   3                              break;
 147   3                      }
 148   2      
 149   2              }
 150   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    505    ----
   CONSTANT SIZE    =     14    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
